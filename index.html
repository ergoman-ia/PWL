<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì‹ ì²´ë¶€ë‹´ ìˆ˜ì¤€ í‰ê°€ (AI)</title>
    <style>
        :root {
            --primary: #2980b9;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #c0392b;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --card-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f6f9;
            color: #333;
            margin: 0;
            padding: 15px;
            line-height: 1.5;
            -webkit-tap-highlight-color: transparent;
        }

        h1 {
            text-align: center;
            font-size: 1.5rem;
            color: var(--dark);
            margin: 10px 0 5px 0;
            letter-spacing: -0.5px;
        }

        .subtitle {
            text-align: center;
            font-size: 0.85rem;
            color: #7f8c8d;
            margin-bottom: 25px;
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #eaeaea;
        }

        .section-header {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f2f5;
            display: flex;
            align-items: center;
        }

        /* Age Input Style */
        .input-wrapper {
            margin-bottom: 5px;
        }

        .input-wrapper label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #bdc3c7;
            border-radius: 8px;
            font-size: 1.1rem;
            box-sizing: border-box;
            -webkit-appearance: none;
        }

        /* Question Styles (Mobile UI) */
        .q-item {
            margin-bottom: 25px;
        }

        .q-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .q-detail {
            font-size: 0.8rem;
            color: #95a5a6;
            margin-bottom: 10px;
        }

        .radio-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .radio-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px 5px;
            background: #fff;
            border: 1px solid #dcdcdc;
            border-radius: 8px;
            font-size: 0.9rem;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            height: 100%;
        }

        .radio-sub {
            font-size: 0.75rem;
            color: #aaa;
            margin-top: 3px;
        }

        input[type="radio"] {
            display: none;
        }

        input[type="radio"]:checked+.radio-label {
            background-color: #eaf2f8;
            border-color: var(--primary);
            color: var(--primary);
            font-weight: bold;
            box-shadow: 0 0 0 1px var(--primary);
        }

        /* Button */
        .btn-analyze {
            width: 100%;
            padding: 16px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(41, 128, 185, 0.3);
            transition: transform 0.1s;
        }

        .btn-analyze:active {
            transform: scale(0.98);
        }

        /* Result Area */
        #resultArea {
            display: none;
            margin-top: 20px;
        }

        .result-header {
            text-align: center;
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .job-title {
            font-size: 1.5rem;
            font-weight: 800;
            margin: 10px 0;
            line-height: 1.3;
        }

        .match-rate {
            font-size: 0.8rem;
            opacity: 0.8;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .score-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .score-pill {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #ccc;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 8px 8px 0;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .info-label {
            font-weight: bold;
            display: block;
            margin-bottom: 5px;
            color: #333;
        }

        .risk-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }

        .risk-alert {
            color: var(--danger);
            font-weight: bold;
        }

        .tag {
            display: inline-block;
            background: #e8e8e8;
            color: #555;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-bottom: 5px;
        }

        .alert-box {
            background: #fff5f5;
            border: 1px solid #feb2b2;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>

    <h1>ì‹ ì²´ë¶€ë‹´ ìˆ˜ì¤€ í‰ê°€ (AI)</h1>
    <div class="subtitle">ìê°€ ê¸°ì…ì‹ ì¸ê°„ê³µí•™ì  ë¶€í•˜ í‰ê°€</div>

    <div class="card">
        <div class="section-header">ğŸ‘¤ ê·¼ë¡œì ì •ë³´</div>
        <div class="input-wrapper">
            <label for="age">ì—°ë ¹ (ë§Œ ë‚˜ì´)</label>
            <input type="number" id="age" placeholder="ì˜ˆ: 45" value="">
        </div>
        <div style="font-size:0.8rem; color:#888; margin-top:5px;">
            * 50ì„¸ ì´ìƒì€ ê°€ì¤‘ì¹˜ê°€ ë‹¤ë¥´ê²Œ ì ìš©ë©ë‹ˆë‹¤.
        </div>
    </div>

    <div class="card" style="border-left: 4px solid #e67e22;">
        <div class="section-header" style="color: #d35400;">â±ï¸ ì‘ì—… ì†ë„ ë° ì‹œê°„ ì••ë°•</div>
        <label style="display: flex; align-items: flex-start; gap: 10px; cursor: pointer; padding: 5px 0;">
            <input type="checkbox" id="timePressure" style="width: 24px; height: 24px; margin-top: 2px;">
            <div style="font-size: 0.95rem; color: #333;">
                <strong style="display:block;">ë‹¹ì‹ ì˜ ì‘ì—…ì€ ì†ë„ê°€ ë¹ ë¥´ê±°ë‚˜ ì‹œê°„ ì••ë°•(Time pressure)ì´ ì‹¬í•©ë‹ˆê¹Œ?</strong>
                <span style="font-size: 0.8rem; color: #7f8c8d;">* ì‚¬íšŒì‹¬ë¦¬í•™ì  ìš”ì¸ì€ ì‹ ì²´ë¶€í•˜ë¥¼ 10~15% ì´ìƒ ì¦í­ì‹œí‚µë‹ˆë‹¤.</span>
            </div>
        </label>
    </div>

    <div class="card">
        <div class="section-header">âœï¸ ì‘ì—… ë¹ˆë„ ì²´í¬</div>
        <p style="font-size: 0.85rem; color: #666; margin-bottom: 20px;">
            í•˜ë£¨ ì‘ì—… ì‹œê°„ ì¤‘, ê° ë™ì‘ì´ ì°¨ì§€í•˜ëŠ” ë¹„ì¤‘ì„ ì„ íƒí•˜ì„¸ìš”.
        </p>

        <form id="ergoForm">
        </form>

        <button class="btn-analyze" onclick="analyze()">AI ì •ë°€ ë¶„ì„ ì‹¤í–‰</button>
    </div>

    <div id="resultArea">
        <div class="result-header">
            <div class="match-rate">AI Detected Profile</div>
            <div class="job-title" id="resTitle">ë¶„ì„ ê²°ê³¼</div>
            <div class="score-row">
                <div class="score-pill" id="resScore">ì ìˆ˜: -</div>
                <div class="score-pill" id="resLevel">ë“±ê¸‰: -</div>
            </div>
        </div>

        <div class="card">
            <div class="section-header">ğŸ“Š ë¶„ì„ ë¦¬í¬íŠ¸</div>

            <div class="info-box" style="border-left-color: var(--primary);">
                <span class="info-label">ğŸ§ AI íŒë‹¨ ì†Œê²¬</span>
                <span id="resReason">-</span>
            </div>

            <div class="info-box" style="border-left-color: var(--dark);">
                <span class="info-label">ğŸ­ ìœ ì‚¬ ì§ì¢…</span>
                <div id="resExamples">-</div>
            </div>

            <div class="info-box" style="border-left-color: var(--success);">
                <span class="info-label">ğŸ’¡ ë§ì¶¤ ê°œì„  ê¶Œê³ </span>
                <span id="resGuide">-</span>
            </div>

            <div id="criticalAlert" class="alert-box" style="display:none;"></div>
            <div id="ageAlert" class="alert-box"
                style="display:none; background:#fffaf0; border-color:#fbd38d; color:#9c4221;"></div>
        </div>

        <div class="card">
            <div class="section-header">âš ï¸ í•­ëª©ë³„ ìœ„í—˜ë„</div>
            <div id="riskList"></div>
        </div>
    </div>

    <script>
        // 1. ì§ˆë¬¸ ë°ì´í„°
        const questions = [
            { id: 'q1', text: "1. ì„œ ìˆê±°ë‚˜ ê±·ê¸°", detail: "ì¥ì‹œê°„ ì œìë¦¬ ì„œê¸° ë˜ëŠ” ì´ë™" },
            { id: 'q2', text: "2. í—ˆë¦¬ êµ½í˜/ë¹„í‹€ê¸°", detail: "ì¸ì‚¬í•˜ëŠ” ìì„¸ ë˜ëŠ” íšŒì „" },
            { id: 'q3', text: "3. ì–´ê¹¨ ìœ„ íŒ” ë“¤ê¸°", detail: "ì†ì´ ì–´ê¹¨ ë†’ì´ ì´ìƒ" },
            { id: 'q4', text: "4. ë°˜ë³µì  íŒ” ë™ì‘", detail: "ë¹ ë¥¸ ì†ë„ì˜ ì†/íŒ” ë°˜ë³µ" },
            { id: 'q5', text: "5. ìª¼ê·¸ë ¤ ì•‰ê¸°/ë¬´ë¦ ê¿‡ê¸°", detail: "ë°”ë‹¥ ì‘ì—…, ë¬´ë¦ ê¿‡ê¸°" },
            { id: 'q6', text: "6. ë°€ê¸° ë˜ëŠ” ë‹¹ê¸°ê¸°", detail: "ì¹´íŠ¸, ëŒ€ì°¨, ì¤‘ëŸ‰ë¬¼ ê²¬ì¸" },
            { id: 'q7', text: "7. ë¬¼ê±´ ë“¤ê¸°/ìš´ë°˜", detail: "ì¤‘ëŸ‰ë¬¼ ì§ì ‘ ì·¨ê¸‰" }
        ];

        // 2. ì„ íƒì§€ (ê°’ ë§¤í•‘)
        const options = [
            { label: "ì „í˜€ ì—†ìŒ", sub: "0%", val: 0 },
            { label: "ì•„ì£¼ ì¡°ê¸ˆ", sub: "~10%", val: 12.5 },
            { label: "ê°€ë”", sub: "25%", val: 25 },
            { label: "ë°˜ë°˜", sub: "50%", val: 50 },
            { label: "ìì£¼", sub: "75%", val: 75 },
            { label: "ê±°ì˜ ë‚´ë‚´", sub: "100%", val: 100 }
        ];

        // 3. 15ê°€ì§€ ì •ë°€ ì‘ì—… í”„ë¡œí•„ (Logic Ver 4.0)
        const profiles = [
            {
                id: 'floor_repetitive',
                name: 'ğŸ”¥ ì €ìƒ ë°˜ë³µ/ì •ë°€í˜• (High Risk)',
                weights: { q1: 10, q2: 60, q3: 30, q4: 100, q5: 100, q6: 0, q7: 20 },
                examples: ['ìš©ì ‘(ì €ìƒ/íŒŒì´í”„)', 'ì •ë°€ ì‚¬ìƒ(Grinding)', 'íƒ€ì¼ ì¤„ëˆˆ ì‹œê³µ', 'ê¸°ê³„ í•˜ë¶€ ì •ë¹„', 'ê±´ë¬¼ ì²­ì†Œ'],
                reason: "ìª¼ê·¸ë ¤ ì•‰ì•„ í•˜ì²´ í˜ˆë¥˜ê°€ ì œí•œëœ ìƒíƒœ(Q5)ì—ì„œ ìƒì§€ë¥¼ ê³¼ë„í•˜ê²Œ ì‚¬ìš©(Q4)í•˜ëŠ” ìµœê³  ìœ„í—˜êµ°ì…ë‹ˆë‹¤.",
                guide: "ë¬´ë¦ ë³´í˜¸ëŒ€ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•©ë‹ˆë‹¤. ë°”í€´ ë‹¬ë¦° ì‘ì—… ì˜ì(Creeper)ë¥¼ ë„ì…í•´ ë¬´ë¦ êµ´ê³¡ì„ ì—†ì• ê³ , 30ë¶„ ì‘ì—…/5ë¶„ ìŠ¤íŠ¸ë ˆì¹­ ì‚¬ì´í´ì„ ê°•ì œí•´ì•¼ í•©ë‹ˆë‹¤."
            },
            // ... (ë‚˜ë¨¸ì§€ í”„ë¡œí•„ë“¤ì€ ê¸°ì¡´ ìœ ì§€, ì•„ë˜ analyze í•¨ìˆ˜ì—ì„œ ë™ì  ì²˜ë¦¬ë¨) ...
            { id: 'floor_heavy', name: 'ğŸ—ï¸ ì €ìƒ ì¤‘ëŸ‰/ì„¤ì¹˜í˜•', weights: { q1: 20, q2: 90, q3: 20, q4: 30, q5: 100, q6: 20, q7: 80 }, examples: ['íƒ€ì¼ ìš´ë°˜/ë¶€ì°©', 'ë°”ë‹¥ ë°°ê´€', 'ì¡°ê²½', 'ë³´ë„ë¸”ëŸ­'], reason: "ë°”ë‹¥ ìì„¸(Q5)ì—ì„œ ì¤‘ëŸ‰ë¬¼(Q7)ê³¼ í—ˆë¦¬ í˜(Q2)ì„ ë™ì‹œì— ì‚¬ìš©í•˜ëŠ” ìš”ì¶” ê³ ìœ„í—˜êµ°ì…ë‹ˆë‹¤.", guide: "ìì¬ë¥¼ ë°”ë‹¥ì— ë‘ì§€ ë§ˆì‹­ì‹œì˜¤. ë†’ì´ ì¡°ì ˆ ëŒ€ì°¨(Lift table)ë¥¼ ì‚¬ìš©í•´ í—ˆë¦¬ êµ½í˜ì„ ì›ì²œ ì°¨ë‹¨í•´ì•¼ í•©ë‹ˆë‹¤." },
            { id: 'confined_space', name: 'ğŸ•³ï¸ í˜‘ì†Œê³µê°„/ì •ë¹„í˜•', weights: { q1: 20, q2: 100, q3: 40, q4: 50, q5: 80, q6: 0, q7: 20 }, examples: ['ì—”ì§„ë£¸', 'íƒ±í¬ ë‚´ë¶€', 'ë§¨í™€', 'ë°°ê´€ ë³´ìˆ˜'], reason: "ì¢ì€ ê³µê°„ ì œì•½ìœ¼ë¡œ ëª¸ì„ ë¹„í‹€ê³ (Q2) êµ¬ë¶€ë¦¬ëŠ”(Q5) ìì„¸ê°€ ê°•ìš”ë©ë‹ˆë‹¤.", guide: "ì—°ì† ì‘ì—… ì‹œê°„ì„ 15ë¶„ìœ¼ë¡œ ì œí•œí•˜ê³ , ì™¸ë¶€ ê³µê°„ì—ì„œì˜ ì „ì‹  ì‹ ì „(Stretching)ì„ ì‘ì—… ì ˆì°¨ì— í¬í•¨ì‹œí‚¤ì„¸ìš”." },
            { id: 'assembly_standing', name: 'âš™ï¸ ì…ì‹ ë¼ì¸ ì¡°ë¦½í˜•', weights: { q1: 100, q2: 20, q3: 20, q4: 100, q5: 0, q6: 0, q7: 10 }, examples: ['ìë™ì°¨ ì˜ì¥', 'ì „ìì œí’ˆ í¬ì¥', 'ì„ ë³„ ë¼ì¸', 'ë¯¸ìš©ì‚¬', 'ìš”ë¦¬/ì œë¹µ'], reason: "ì¥ì‹œê°„ ê¸°ë¦½(Q1)ê³¼ ìƒì§€ ë°˜ë³µ(Q4)ì´ ê²°í•©ëœ ì „í˜•ì ì¸ ì¡°ë¦½ ê³µì •ì…ë‹ˆë‹¤.", guide: "ì‘ì—… ë†’ì´ë¥¼ íŒ”ê¿ˆì¹˜ ì•„ë˜ 5~10cmë¡œ ì¡°ì •í•˜ê³ , ì…ì‹ ì˜ì(Standing stool)ì™€ í”¼ë¡œ ì˜ˆë°© ë§¤íŠ¸ë¥¼ ë™ì‹œì— ì§€ê¸‰í•˜ì„¸ìš”." },
            { id: 'overhead_static', name: 'ğŸ¨ ìƒí–¥/ê³ ì†Œ ì •ë°€í˜•', weights: { q1: 80, q2: 40, q3: 100, q4: 80, q5: 0, q6: 0, q7: 10 }, examples: ['ì²œì¥ ë„ì¥', 'ì „ë“±/ë°°ì„ ', 'ë•íŠ¸ ì„¤ì¹˜', 'ì°¨ëŸ‰ í•˜ë¶€'], reason: "ì–´ê¹¨ ìœ„ ì‘ì—…(Q3)ê³¼ ë°˜ë³µ ë™ì‘(Q4)ì€ íšŒì „ê·¼ê°œ ì†ìƒì˜ ì§ì ‘ì  ì›ì¸ì…ë‹ˆë‹¤.", guide: "ëª© ì –í˜ ë°©ì§€ í”„ë¦¬ì¦˜ ì•ˆê²½ê³¼ íŒ” ì§€ì§€ëŒ€(Exoskeleton) ë„ì…ì´ ì‹œê¸‰í•©ë‹ˆë‹¤." },
            { id: 'heavy_logistic', name: 'ğŸ“¦ ë™ì  ë¬¼ë¥˜/í•˜ì—­í˜•', weights: { q1: 100, q2: 50, q3: 10, q4: 20, q5: 10, q6: 30, q7: 100 }, examples: ['ìƒí•˜ì°¨', 'ê³°ë°©', 'ì´ì‚¬ì§', 'ìì¬ ì ì¬','ì •ìœ¡/ë„ì¶•'], reason: "ì´ë™(Q1)ê³¼ ê³ ì¤‘ëŸ‰ ì·¨ê¸‰(Q7)ì´ ê²°í•©ëœ ì „ì‹  ê·¼ìœ¡ ì†Œëª¨í˜• ì‘ì—…ì…ë‹ˆë‹¤.", guide: "í—ˆë¦¬ íšŒì „(Twisting)ì„ ê¸ˆì§€í•˜ê³  ë°œì„ ì›€ì§ì—¬ ë°©í–¥ì„ ì „í™˜í•˜ì„¸ìš”. íŒŒì›Œ ê·¸ë¦½ ì¥ê°‘ ì°©ìš© í•„ìˆ˜." },
            { id: 'push_pull_cart', name: 'ğŸ›’ ì¤‘ëŸ‰ ê²¬ì¸í˜•', weights: { q1: 90, q2: 30, q3: 0, q4: 0, q5: 0, q6: 100, q7: 20 }, examples: ['ëŒ€ì°¨ ìš´ë°˜', 'í™˜ì ì´ì†¡', 'ë¡¤í…Œì´ë„ˆ'], reason: "ê³¼ë„í•œ ë¯¸ëŠ” í˜(Q6)ì— ì˜í•œ ì–´ê¹¨ ë° ìš”ì¶” ë¶€ë‹´ íŒ¨í„´ì…ë‹ˆë‹¤.", guide: "ë°”í€´ ìœ ì§€ë³´ìˆ˜ë¥¼ ìµœìš°ì„ ìœ¼ë¡œ í•˜ê³ , ì´ˆê¸° ê¸°ë™ ì‹œ ì²´ì¤‘ì„ ì‹¤ì–´ ë¯¸ëŠ” êµìœ¡ì„ ì‹¤ì‹œí•˜ì„¸ìš”." },
            { id: 'precision_sedentary', name: 'ğŸ”¬ ì¢Œì‹ ì •ë°€/ê²€ì‚¬í˜•', weights: { q1: 0, q2: 40, q3: 20, q4: 100, q5: 0, q6: 0, q7: 0 }, examples: ['ë¯¸ì‹±', 'PCB ë‚©ë•œ', 'í˜„ë¯¸ê²½ ê²€ì‚¬'], reason: "ì¢Œì‹ ì •ì  ìì„¸ì™€ ì†ê°€ë½ ë°˜ë³µ ë™ì‘(Q4)ì´ ê²°í•©ë˜ì—ˆìŠµë‹ˆë‹¤.", guide: "íŒ”ê¿ˆì¹˜ ë°›ì¹¨ëŒ€(Arm rest) ì„¤ì¹˜ ë° 50ë¶„ ì‘ì—…/10ë¶„ ìŠ¤íŠ¸ë ˆì¹­ ì¤€ìˆ˜." },
            { id: 'standing_guard', name: 'ğŸ‘® ì…ì‹ ê°ì‹œ/ì„œë¹„ìŠ¤í˜•', weights: { q1: 100, q2: 0, q3: 0, q4: 10, q5: 0, q6: 0, q7: 0 }, examples: ['ë³´ì•ˆ', 'ì•ˆë‚´', 'êµí†µ ì •ë¦¬'], reason: "ì›€ì§ì„ ì—†ëŠ” ê¸°ë¦½ ìì„¸(Q1)ë¡œ ì¸í•œ í•˜ì§€ ì •ë§¥ë¥˜ ìœ„í—˜êµ°ì…ë‹ˆë‹¤.", guide: "ë°œíŒ(Foot rest)ì„ ë‘ì–´ ì²´ì¤‘ì„ ì´ë™ì‹œí‚¤ê³ , ì••ë°• ìŠ¤íƒ€í‚¹ ì°©ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤." },
            { id: 'construction_general', name: 'ğŸ§± ê±´ì„¤/ë³µí•© ê³ ê°•ë„í˜•', weights: { q1: 80, q2: 80, q3: 60, q4: 40, q5: 60, q6: 40, q7: 80 }, examples: ['í˜•í‹€', 'ì² ê·¼', 'ë¹„ê³„', 'ì„ê³µ'], reason: "ì‹ ì²´ ì „ë°˜ì˜ ì—ë„ˆì§€ ì†Œëª¨ê°€ ê·¹ì‹¬í•œ ë³µí•© ê³ ê°•ë„ ì‘ì—…ì…ë‹ˆë‹¤.", guide: "ì‘ì—… ê°•ë„ì— ë”°ë¥¸ ì² ì €í•œ íœ´ê²Œ ì‹œê°„ ë³´ì¥ ë° ì‘ì—… ìˆœí™˜(Job Rotation) ì‹¤ì‹œ." },
            { id: 'patient_care', name: 'ğŸ¥ ë³µí•© ëŒë´„/ê°„í˜¸í˜•', weights: { q1: 75, q2: 75, q3: 0, q4: 25, q5: 25, q6: 50, q7: 50 }, examples: ['ê°„í˜¸ì‚¬', 'ìš”ì–‘ë³´í˜¸ì‚¬'], reason: "í™˜ì ì´ì†¡ ì‹œ ë°œìƒí•˜ëŠ” ëŒë°œì ì¸ ë¶€í•˜ì™€ ë¹„í‹€ë¦¼(Q2)ì´ ìœ„í—˜ ìš”ì¸ì…ë‹ˆë‹¤.", guide: "ìŠ¬ë¼ì´ë”© ì‹œíŠ¸ ë“± ë³´ì¡° ë„êµ¬ ì‚¬ìš©ì„ ì˜ë¬´í™”í•˜ê³ , ì¹¨ëŒ€ ë†’ì´ë¥¼ í—ˆë¦¬ ë†’ì´ë¡œ ë§ì¶”ì„¸ìš”." },
            { id: 'driver', name: 'ğŸš› ìš´ì „/ì§„ë™í˜•', weights: { q1: 0, q2: 50, q3: 0, q4: 0, q5: 0, q6: 0, q7: 20 }, examples: ['í™”ë¬¼ ìš´ì „', 'ì§€ê²Œì°¨'], reason: "ì¥ì‹œê°„ ì¢Œì‹ ìì„¸ì—ì„œì˜ ì§„ë™ ë…¸ì¶œê³¼ í—ˆë¦¬ ë¶€ë‹´ì´ í•µì‹¬ì…ë‹ˆë‹¤.", guide: "ê³µê¸°ì•• ì„œìŠ¤íœì…˜ ì‹œíŠ¸ ì ìš© ë° 2ì‹œê°„ë§ˆë‹¤ í•˜ì°¨í•˜ì—¬ ìŠ¤íŠ¸ë ˆì¹­ í•„ìˆ˜." },
            { id: 'office_admin', name: 'ğŸ’» ì¼ë°˜ ì‚¬ë¬´/ê´€ë¦¬í˜•', weights: { q1: 10, q2: 0, q3: 0, q4: 20, q5: 0, q6: 0, q7: 0 }, examples: ['ì‚¬ë¬´', 'ì„¤ê³„', 'ì½œì„¼í„°'], reason: "ì‹ ì²´ì  ë¶€í•˜ëŠ” ì ìœ¼ë‚˜ VDT ì¦í›„êµ° ì˜ˆë°©ì´ í•„ìš”í•©ë‹ˆë‹¤.", guide: "ëª¨ë‹ˆí„° ìƒë‹¨ì„ ëˆˆë†’ì´ì— ë§ì¶”ê³ , ì˜ì ê¹Šìˆ™ì´ ì•‰ëŠ” ìŠµê´€ì„ ë“¤ì´ì„¸ìš”." },
            { id: 'active_mobile', name: 'ğŸƒ í™œë™ì  ì´ë™í˜•', weights: { q1: 100, q2: 0, q3: 0, q4: 0, q5: 0, q6: 0, q7: 50 }, examples: ['ë°°ë‹¬', 'ê²€ì¹¨', 'ì„œë¹™'], reason: "ë†’ì€ ì´ë™ëŸ‰(Q1)ì— ì˜í•œ í•˜ì§€ í”¼ë¡œ ëˆ„ì ì´ ì£¼ëœ ë¬¸ì œì…ë‹ˆë‹¤.", guide: "ì¶©ê²© í¡ìˆ˜ ì‘ì—…í™”(ì›Œí‚¹í™”) ì§€ê¸‰ ë° íœ´ì‹ ì‹œ ë‹¤ë¦¬ë¥¼ ë†’ê²Œ ì˜¬ë¦¬ì„¸ìš”." }
        ];

        // 4. UI ë Œë”ë§
        function renderForm() {
            const form = document.getElementById('ergoForm');
            let html = '';

            questions.forEach(q => {
                html += `
                <div class="q-item">
                    <div class="q-title">${q.text}</div>
                    <div class="q-detail">${q.detail}</div>
                    <div class="radio-group">
                        ${options.map((opt, idx) => `
                            <label>
                                <input type="radio" name="${q.id}" value="${opt.val}">
                                <div class="radio-label">
                                    <span>${opt.label}</span>
                                    <div class="radio-sub">${opt.sub}</div>
                                </div>
                            </label>
                        `).join('')}
                    </div>
                </div>
            `;
            });
            form.innerHTML = html;
        }

        // 5. í•µì‹¬ ë¶„ì„ í•¨ìˆ˜ (AI Logic)
        function analyze() {
            // A. ì…ë ¥ê°’ ê²€ì¦ ë° ë°ì´í„° ìˆ˜ì§‘
            const ageVal = document.getElementById('age').value;
            if (!ageVal) { alert('ì •í™•í•œ ë¶„ì„ì„ ìœ„í•´ ì—°ë ¹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); document.getElementById('age').focus(); return; }
            const age = parseInt(ageVal);

            const userScores = {};
            let totalScore = 0;
            let allChecked = true;

            questions.forEach(q => {
                const checked = document.querySelector(`input[name="${q.id}"]:checked`);
                if (!checked) allChecked = false;
                else {
                    userScores[q.id] = parseFloat(checked.value);
                    totalScore += userScores[q.id];
                }
            });

            if (!allChecked) { alert('ëª¨ë“  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }

            // B. Index ê³„ì‚° (ê¸°ë³¸ê°’)
            let baseIndex = (totalScore / 7);
            let ergoIndex = baseIndex;

            // â˜… ìƒˆë¡œ ì¶”ê°€: ì‹œê°„ ì••ë°• ê°€ì¤‘ì¹˜ (Multiplier) ì ìš© â˜…
            const hasTimePressure = document.getElementById('timePressure').checked;
            let timePressureWarning = "";
            
            if (hasTimePressure) {
                ergoIndex = baseIndex * 1.15; // ì‹œê°„ ì••ë°• ì‹œ ì§€ìˆ˜ 15% ì¦í­
                timePressureWarning = `
                    <div style="margin-top:10px; padding:10px; background:#fff3cd; border:1px solid #ffeeba; border-radius:6px; color:#856404; font-size:0.85rem;">
                        <strong>â±ï¸ ì‹œê°„ ì••ë°•(Time Pressure) ê²½ê³ :</strong><br>
                        ë¹ ë¥¸ ì‘ì—… ì†ë„ë¡œ ì¸í•´ ê·¼ìœ¡ ê¸´ì¥ë„ê°€ ë†’ì•„ì§€ê³  íœ´ì‹(ë¯¸ì„¸ íšŒë³µ)ì´ ë¶€ì¡±í•œ ìƒíƒœì…ë‹ˆë‹¤. ì‹ ì²´ì  ë¶€í•˜ ì ìˆ˜ì— 15%ì˜ ê°€ì¤‘ì¹˜ê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.
                    </div>`;
            }
            
            // ì†Œìˆ˜ì  1ìë¦¬ë¡œ ì •ë¦¬
            ergoIndex = ergoIndex.toFixed(1);

            // C. í”„ë¡œí•„ ë§¤ì¹­ (Weighted Distance)
            let bestMatch = null;
            let minDiff = Infinity;

            profiles.forEach(prof => {
                let diffSum = 0;
                for (let key in prof.weights) {
                    let w = prof.weights[key];
                    let u = userScores[key];
                    // ê°€ì¤‘ì¹˜: ìª¼ê·¸ë ¤ ì•‰ê¸°(Q5)ì™€ ë°˜ë³µ(Q4)ì˜ ì¤‘ìš”ë„ ê°•í™”
                    let factor = 1;
                    if (key === 'q5' && w >= 80) factor = 2.5;
                    if (key === 'q4' && w >= 80) factor = 1.5;
                    diffSum += Math.pow((u - w) * factor, 2);
                }
                if (diffSum < minDiff) { minDiff = diffSum; bestMatch = prof; }
            });

            // ê°•ì œ ë³´ì • ë¡œì§ (ì €ìƒ ì‘ì—… ìš°ì„ )
            if (userScores.q5 >= 70 && !bestMatch.id.includes('floor') && !bestMatch.id.includes('confined')) {
                let floorProfiles = profiles.filter(p => p.id.includes('floor') || p.id.includes('confined'));
                let subMin = Infinity;
                floorProfiles.forEach(p => {
                    let d = 0;
                    for (let k in p.weights) d += Math.pow(userScores[k] - p.weights[k], 2);
                    if (d < subMin) { subMin = d; bestMatch = p; }
                });
            }

            // =========================================================================
            // â˜… [í•µì‹¬ ìˆ˜ì •] ë™ì  ë³µí•© ì²˜ë°© ìƒì„±ê¸° (Dynamic Compound Prescription) â˜…
            // =========================================================================

            let finalGuide = bestMatch.guide; // ê¸°ë³¸ê°’ì€ í”„ë¡œí•„ì˜ ê°€ì´ë“œ
            let finalReason = bestMatch.reason;

            // [ì‹œë‚˜ë¦¬ì˜¤ 1] ì§ˆë¬¸ìë‹˜ ì¼€ì´ìŠ¤: ë°˜ë³µ(Q4) High + ìª¼ê·¸ë ¤ ì•‰ê¸°(Q5) High
            // ê¸°ì¤€: ë‘˜ ë‹¤ 50% ì´ìƒ (75%ë©´ ë‹¹ì—°íˆ í¬í•¨ë¨)
            if (userScores.q4 >= 50 && userScores.q5 >= 50) {
                // ì „ë¬¸ê°€ ì½”ë©˜íŠ¸ë¡œ ë®ì–´ì“°ê¸° (HTML íƒœê·¸ í™œìš©í•˜ì—¬ ê°•ì¡°)
                finalGuide = `
                <div style="margin-bottom:8px; color:#c0392b; font-weight:bold;">ğŸš¨ [ê¸´ê¸‰ ë³µí•© ì²˜ë°©] í•˜ì§€ ê³ ì • + ìƒì§€ ë°˜ë³µ</div>
                <ul style="margin:0; padding-left:20px; color:#333;">
                    <li><strong>ì—”ì§€ë‹ˆì–´ë§ ê°œì„ (í•„ìˆ˜):</strong> ìª¼ê·¸ë ¤ ì•‰ì€ ìƒíƒœì˜ ë°˜ë³µ ì‘ì—…ì€ ê·¼ê³¨ê²©ê³„ ì†ìƒì„ ê°€ì†í™”í•©ë‹ˆë‹¤. <u>ë°”í€´ ë‹¬ë¦° ë‚®ì€ ì˜ì(Creeper Seat)</u>ë¥¼ ë°˜ë“œì‹œ ë„ì…í•˜ì—¬ ë¬´ë¦ì„ í´ê³  ì‘ì—…í•´ì•¼ í•©ë‹ˆë‹¤.</li>
                    <li><strong>ì‘ì—…ë¬¼ ë†’ì´ ì¡°ì ˆ:</strong> í•˜ì²´ê°€ ê³ ì •ë˜ë©´ ìƒì²´ ê°€ë™ë²”ìœ„ê°€ ì¤„ì–´ë“­ë‹ˆë‹¤. ì‘ì—…ë¬¼ì„ ì§€ë©´ì—ì„œ <u>30cm ì´ìƒ ë„ìš°ëŠ” ì§€ê·¸(Jig)</u>ë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.</li>
                    <li><strong>ê´€ë¦¬ì  ì¡°ì¹˜:</strong> ì´ ì‘ì—…ì€ ì—°ì† 45ë¶„ì„ ë„˜ê¸¸ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íƒ€ ì‘ì—…ê³¼ ìˆœí™˜(Rotation)í•˜ê±°ë‚˜ ê°•ì œ íœ´ì‹ì„ ë¶€ì—¬í•˜ì„¸ìš”.</li>
                </ul>
            `;
                // íŒë‹¨ ê·¼ê±°ë„ ë³µí•©ì ìœ¼ë¡œ ìˆ˜ì •
                finalReason = `<strong>[ë³µí•© ìœ„í—˜]</strong> ë¶€ìì—°ìŠ¤ëŸ¬ìš´ í•˜ì²´ ìì„¸(Q5: ${userScores.q5}%)ì™€ ê³ ë°˜ë³µ ìƒì§€ ì‘ì—…(Q4: ${userScores.q4}%)ì´ ê²°í•©ë˜ì—ˆìŠµë‹ˆë‹¤. í˜ˆë¥˜ ì œí•œê³¼ ê·¼í”¼ë¡œ ëˆ„ì ì´ ë™ì‹œì— ë°œìƒí•˜ì—¬ ë‹¨ë… ìœ„í—˜ë³´ë‹¤ í›¨ì”¬ ì¹˜ëª…ì ì…ë‹ˆë‹¤.`;
            }

            // [ì‹œë‚˜ë¦¬ì˜¤ 2] ì¤‘ëŸ‰ë¬¼(Q7) High + í—ˆë¦¬ êµ½í˜(Q2) High (ë˜ ë‹¤ë¥¸ ê³ ìœ„í—˜ íŒ¨í„´)
            else if (userScores.q7 >= 50 && userScores.q2 >= 50) {
                finalGuide = `
                <div style="margin-bottom:8px; color:#d35400; font-weight:bold;">âš ï¸ [ë³µí•© ì²˜ë°©] ì¤‘ëŸ‰ë¬¼ ì·¨ê¸‰ + ë¶€ì ì ˆ ìì„¸</div>
                <ul style="margin:0; padding-left:20px; color:#333;">
                    <li><strong>ì¥ë¹„ ë„ì…:</strong> í—ˆë¦¬ë¥¼ êµ½íŒ ì±„ í˜ì„ ì“°ëŠ” ë™ì‘ì€ ë””ìŠ¤í¬ íŒŒì—´ ìœ„í—˜ì´ ë†’ìŠµë‹ˆë‹¤. <u>ë†’ì´ ì¡°ì ˆí˜• ëŒ€ì°¨(Lift Table)</u>ë¥¼ ì‚¬ìš©í•˜ì—¬ í—ˆë¦¬ êµ½í˜ì„ 0ìœ¼ë¡œ ë§Œë“œì„¸ìš”.</li>
                    <li><strong>ë™ì‘ ì›ì¹™:</strong> ë¬¼ê±´ì„ ëª¸ì— ìµœëŒ€í•œ ë°€ì°©ì‹œí‚¤ê³ , í—ˆë¦¬ íšŒì „ ëŒ€ì‹  ë°œì„ ì›€ì§ì—¬ ë°©í–¥ì„ ì „í™˜í•˜ì„¸ìš”.</li>
                </ul>
            `;
                finalReason = `<strong>[LBI ê³ ìœ„í—˜]</strong> í—ˆë¦¬ë¥¼ êµ½íŒ ìƒíƒœ(Q2)ì—ì„œ ì¤‘ëŸ‰ë¬¼ ë¶€í•˜(Q7)ê°€ ê°€í•´ì ¸ ì²™ì¶” ë””ìŠ¤í¬ ì••ë ¥ì´ í—ˆìš© í•œê³„ë¥¼ ì´ˆê³¼í•  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.`;
            }

            // [ì‹œë‚˜ë¦¬ì˜¤ 3] ì–´ê¹¨ ìœ„(Q3) High + ë°˜ë³µ(Q4) High
            else if (userScores.q3 >= 50 && userScores.q4 >= 50) {
                finalGuide = `
                <div style="margin-bottom:8px; color:#e67e22; font-weight:bold;">âš ï¸ [ë³µí•© ì²˜ë°©] ì–´ê¹¨ ìœ„ ì‘ì—… + ë°˜ë³µ ë™ì‘</div>
                <ul style="margin:0; padding-left:20px; color:#333;">
                    <li><strong>ìì„¸ ê°œì„ :</strong> ì‘ì—… ë°œíŒì„ ë†’ì´ê±°ë‚˜ ì‘ì—…ë¬¼ì„ ë‚®ì¶”ì–´ ì†ì˜ ìœ„ì¹˜ë¥¼ <u>ì–´ê¹¨ ì•„ë˜(ì‹¬ì¥ ë†’ì´)</u>ë¡œ ì¡°ì •í•˜ëŠ” ê²ƒì´ ìµœìš°ì„ ì…ë‹ˆë‹¤.</li>
                    <li><strong>ë³´ì¡°êµ¬ í™œìš©:</strong> ê°œì„ ì´ ì–´ë µë‹¤ë©´ íŒ”ì˜ ë¬´ê²Œë¥¼ ì§€íƒ±í•´ì£¼ëŠ” <u>ì›¨ì–´ëŸ¬ë¸” ìŠˆíŠ¸(Exoskeleton)</u> ë„ì…ì„ ê²€í† í•˜ì„¸ìš”.</li>
                </ul>
            `;
                finalReason = `<strong>[íšŒì „ê·¼ê°œ ì£¼ì˜]</strong> íŒ”ì„ ë“¤ê³  ìˆëŠ” ì •ì  ë¶€í•˜(Q3)ì— ë°˜ë³µ ë™ì‘(Q4)ì´ ë”í•´ì ¸ ì–´ê¹¨ ê±´(Tendon)ì˜ ë§ˆëª¨ê°€ ê°€ì†í™”ë©ë‹ˆë‹¤.`;
            }


            // E. ê²°ê³¼ ì¶œë ¥ (ìˆ˜ì •ëœ finalGuide, finalReason ì ìš©)
            document.getElementById('resTitle').innerText = bestMatch.name;
            document.getElementById('resReason').innerHTML = finalReason + timePressureWarning; // â˜… ì‹œê°„ ì••ë°• ê²½ê³  ë©”ì‹œì§€ ë³‘í•©

            let tags = '';
            bestMatch.examples.forEach(ex => tags += `<span class="tag">${ex}</span>`);
            document.getElementById('resExamples').innerHTML = tags;

            document.getElementById('resGuide').innerHTML = finalGuide; // innerHTMLë¡œ ë³€ê²½

            // ì ìˆ˜ ë° ë“±ê¸‰ í‘œì‹œ
            document.getElementById('resScore').innerText = `ì ìˆ˜: ${ergoIndex}`;
            let levelText = "", levelColor = "";
            if (ergoIndex <= 10) { levelText = "ë‚®ìŒ (Low)"; levelColor = "#27ae60"; }
            else if (ergoIndex <= 20) { levelText = "ë³´í†µ (Mod)"; levelColor = "#f39c12"; }
            else if (ergoIndex <= 30) { levelText = "ë†’ìŒ (High)"; levelColor = "#d35400"; }
            else { levelText = "ë§¤ìš° ë†’ìŒ"; levelColor = "#c0392b"; }

            const lvlEl = document.getElementById('resLevel');
            lvlEl.innerText = `ë“±ê¸‰: ${levelText}`;
            lvlEl.style.backgroundColor = levelColor;
            lvlEl.style.color = "white";

            // ìœ„í—˜ ë¦¬ìŠ¤íŠ¸ ì¶œë ¥
            const riskList = document.getElementById('riskList');
            riskList.innerHTML = '';
            questions.forEach(q => {
                const val = userScores[q.id];
                let threshold = 25;
                if (q.id === 'q1') threshold = 50;
                if (['q5', 'q6', 'q7'].includes(q.id)) threshold = 12.5;

                if (val >= threshold) {
                    riskList.innerHTML += `
                    <div class="risk-item">
                        <span>${q.text.split('.')[1]}</span>
                        <span class="risk-alert">${val}% (ì£¼ì˜)</span>
                    </div>
                `;
                }
            });

            // ì—°ë ¹ ê²½ê³ 
            const ageAlert = document.getElementById('ageAlert');
            if (age >= 50 && ergoIndex > 10) {
                ageAlert.style.display = 'block';
                ageAlert.innerHTML = `âš ï¸ <strong>ì—°ë ¹ ê²½ê³  (${age}ì„¸):</strong> 50ì„¸ ì´ìƒì€ í˜„ì¬ ì‘ì—… ê°•ë„ì—ì„œ íšŒë³µë ¥ì´ ì €í•˜ë˜ì–´ ë³‘ê°€ ìœ„í—˜ì´ 2ë°° ë†’ìŠµë‹ˆë‹¤. íœ´ì‹ ì‹œê°„ì„ ëŠ˜ë¦¬ì„¸ìš”.`;
            } else {
                ageAlert.style.display = 'none';
            }

            // ì¤‘ìš”: criticalAlertì€ ìœ„ ë³µí•© ì²˜ë°© ë¡œì§ì— í†µí•©ë˜ì—ˆìœ¼ë¯€ë¡œ ìˆ¨ê¹€ ì²˜ë¦¬ (ì¤‘ë³µ ë°©ì§€)
            document.getElementById('criticalAlert').style.display = 'none';

            // í™”ë©´ ì´ë™
            document.getElementById('resultArea').style.display = 'block';
            setTimeout(() => { document.getElementById('resultArea').scrollIntoView({ behavior: 'smooth' }); }, 100);
        }

        // ì´ˆê¸°í™”
        renderForm();

    </script>
</body>
</html>
